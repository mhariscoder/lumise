jQuery(document).ready((function(t){var e=t("#lumise-popup"),a=function(){e.animate({opacity:0},250,(function(){e.hide()})),e.find(".lumise-popup-content").animate({top:"-50px",opacity:0},250)},i=function(){done<total?t("#lumise-cliparts-bundle-stt").html('<i class="fa fa-spinner fa-spin fa-fw"></i> Processing '+done+"/"+total):t("#lumise-cliparts-bundle-stt").html("Processed "+done+"/"+total)},n=function(e){if(-1===e.indexOf("image/svg+xml"))return e;(e=e.split(","))[1]=t("<div>"+atob(e[1].replace("viewbox=","viewBox="))+"</div>"),e[1].find("[id]").each((function(){this.id=this.id.replace(/[\u{0080}-\u{FFFF}]/gu,"")}));var a=e[1].find("svg").get(0);if(a.getAttribute("width")||a.setAttribute("width","1000px"),!a.getAttribute("height")){var i=a.getAttribute("viewBox").trim().split(" ");a.setAttribute("height",parseFloat(i[3])/parseFloat(i[2])*1e3+"px")}return e[1]=btoa(e[1].html()),e[0]+","+e[1]},l=function(e){t("#lumise-list-categories").html('<br><center><i class="fa fa-spinner fa-2x fa-spin fa-fw"></i></center><br>'),t.ajax({url:LumiseDesign.ajax,method:"POST",data:{action:"categories",nonce:"LUMISE_ADMIN_cliparts:"+nonce,data:void 0!==e?e:""},statusCode:{403:function(){location.reload()}},success:function(e){var a=[],i=['<option value="0">None</option>'];e.length>0?e.map((function(t){a.push('<li style="padding-left:'+20*t.lv+'px">\t\t\t\t\t\t\t\t\t<div class="lumise_checkbox sty2">\t\t\t\t\t\t\t\t\t<input type="checkbox" name="category[]" class="action_check" value="'+t.id+'" class="action" id="'+t.id+'" />\t\t\t\t\t\t\t\t<label for="'+t.id+'">'+t.name+'<em class="check"></em></label>\t\t\t\t\t\t\t\t</div></li>'),i.push('<option value="'+t.id+'">'+"&mdash;".repeat(t.lv)+" "+t.name+"</option>")})):a.push('<p class="no-data">'+lumise.i(89)+"</p>"),t("#lumise-list-categories").html(a.join("")),t("#lumise-parent-categories").html(i.join(""))}}),t("#create-category-form").hide().find("input,select,textarea,img").val("").attr({src:""})};t("#lumise-add-bundle-cliparts").on("click",(function(t){return e.css({opacity:0}).show().animate({opacity:1},250).find("header input").focus(),e.find(".lumise-popup-content").css({top:"-50px",opacity:0}).animate({top:0,opacity:1},250),t.preventDefault(),!1})),e.on("click",(function(t){"lumise-popup"==t.target.id&&(a(),t.preventDefault())})).find("header [data-close]").on("click",(function(t){a(),t.preventDefault()})),t("#lumise-upload-form").on("click",(function(){t(this).find('input[type="file"]').get(0).click()})),t('#lumise-upload-form input[type="file"]').on("change",(function(e){!function(e){for(var a=0;a<e.length;a++)lumise_validate_file(e[a])&&(total++,i(),reader[total]=new FileReader,reader[total].f=total,reader[total].file=e[a],reader[total].addEventListener("load",(function(){var e=n(this.result),a=reader[this.f].file,l=a.name.replace(/[^0-9a-zA-Z\.\-\_]/g,"").trim().replace(/\ /g,"+").split("."),o=[];l.pop(),t('#lumise-list-categories input[type="checkbox"]:checked').map((function(){o.push(this.value)}));var r={upload:{data:e,type:a.type?a.type:a.name.split(".").pop(),size:a.size,name:"lumise-base-"+a.name.replace(/[^0-9a-zA-Z\.\-\_]/g,"").trim().replace(/\ /g,"+")},name:l.join("."),cates:o,tags:t("#lumise-cliparts-tags").val().split(","),price:t("#lumise-cliparts-price").val(),featured:t("#lumise-cliparts-featured").get(0).checked};lumise_create_thumbn({source:e,width:320,callback:function(e){r.upload.thumbn=e,t.ajax({url:LumiseDesign.ajax,method:"POST",data:{action:"add_clipart",nonce:"LUMISE_ADMIN_cliparts:"+nonce,data:JSON.stringify(r)},statusCode:{403:function(){location.reload()}},success:function(e){"object"==typeof e?e.success?(done++,i()):e.error?t("#lumise-cliparts-bundle-stt").html(e.error):t("#lumise-cliparts-bundle-stt").html("Can\t upload at this time"):t("#lumise-cliparts-bundle-stt").html("Can\t upload at this time")}})}}),delete reader[this.f]}),!1),reader[total].readAsDataURL(e[a]))}(this.files)})),t('[data-click="toggle-form"]').on("click",(function(e){return t("#create-category-form").slideToggle(),e.preventDefault(),!1})),t("#create-category-form button.lumise-btn-primary").on("click",(function(e){var a=t('#create-category-form input[name="category[name]"]');if(""===a.val())return a.shake();if(t("#lumise-list-categories label").filter((function(){return this.innerText.toLowerCase()==a.val().toLowerCase()})).length>0)return a.shake();var i=t('#create-category-form select[name="category[parent]"]').val(),n=t('#create-category-form input[name="category[upload]"]').val();return l({name:a.val(),parent:i,upload:n,type:"cliparts"}),e.preventDefault(),!1})),l()}));